<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BVB Insiders - Admin</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    .login, .confessions { background: white; padding: 20px; border-radius: 10px; max-width: 500px; margin: auto; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; }
    input, button { width: 100%; padding: 10px; margin-bottom: 10px; }
    .confession { background: #eee; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
    button.delete { background: red; color: white; border: none; cursor: pointer; }
    button.delete:hover { background: darkred; }
</style>
</head>
<body>

<div class="login" id="loginBox">
    <h2>Admin Login</h2>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <p id="loginStatus"></p>
</div>

<div class="confessions" id="confessionsBox" style="display:none;">
    <h2>All Confessions</h2>
    <div id="confessionList"></div>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyC4tGaHW1D3BUkKPsp46PVeXbcVjozLbjc",
    authDomain: "bvbinsiders.firebaseapp.com",
    projectId: "bvbinsiders",
    storageBucket: "bvbinsiders.appspot.com",
    messagingSenderId: "611204497520",
    appId: "1:611204497520:web:a12419c7f0ff81e019f4b5"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

async function login() {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;
    const status = document.getElementById("loginStatus");

    try {
        await signInWithEmailAndPassword(auth, email, pass);
        status.textContent = "Login successful!";
        status.style.color = "green";
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("confessionsBox").style.display = "block";
        loadConfessions();
    } catch (error) {
        status.textContent = "Login failed!";
        status.style.color = "red";
    }
}

async function loadConfessions() {
    const list = document.getElementById("confessionList");
    list.innerHTML = "";
    const querySnapshot = await getDocs(collection(db, "confessions"));
    querySnapshot.forEach(docSnap => {
        const div = document.createElement("div");
        div.classList.add("confession");
        div.innerHTML = `
            <p>${docSnap.data().text}</p>
            <button class="delete" onclick="deleteConfession('${docSnap.id}')">Delete</button>
        `;
        list.appendChild(div);
    });
}

window.deleteConfession = async function(id) {
    await deleteDoc(doc(db, "confessions", id));
    loadConfessions();
};
</script>
</body>
</html>
